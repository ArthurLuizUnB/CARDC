{% extends "base.html" %}

{% block title %}Novo Ciclo de Estudo{% endblock %}

{% block content %}
    <h2>{{ '✏️ Editando: ' + ciclo.obra if ciclo else '➕ Novo Ciclo de Estudo' }}</h2>

    <form action="{{ url_for('routes.novo_ciclo') if not ciclo else url_for('routes.editar_ciclo', ciclo_id=ciclo.id) }}" method="POST" class="formulario">

        <h3>1º Passo</h3>
        <label for="obra">Obra:</label>
        <input type="text" id="obra" name="obra" required value="{{ ciclo.obra if ciclo else '' }}">

        <label for="compositor">Compositor:</label>
        <input type="text" id="compositor" name="compositor" required value="{{ ciclo.compositor if ciclo else '' }}">

        <label for="data_inicio">Início:</label>
        <input type="date" id="data_inicio" name="data_inicio" required value="{{ ciclo.data_inicio if ciclo else now.strftime('%Y-%m-%d') }}">

        <label for="data_finalizacao">Finalização:</label>
        <input type="date" id="data_finalizacao" name="data_finalizacao" value="{{ ciclo.data_finalizacao if ciclo else '' }}">

        <label for="link_gravacao">Link da gravação:</label>
        <input type="text" id="link_gravacao" name="link_gravacao" value="{{ ciclo.link_gravacao if ciclo else '' }}">

        <h3 class="mt-4">2º Passo</h3>
        <label for="acao_artistica">Ação artística:</label>
        <textarea id="acao_artistica" name="acao_artistica" rows="3">{{ ciclo.acao_artistica if ciclo else '' }}</textarea>

        <label for="descricao_tarefa">Descrição da tarefa:</label>
        <textarea id="descricao_tarefa" name="descricao_tarefa" rows="3">{{ ciclo.descricao_tarefa if ciclo else '' }}</textarea>

        <label for="resultado_tecnico">Resultado técnico:</label>
        <textarea id="resultado_tecnico" name="resultado_tecnico" rows="3">{{ ciclo.resultado_tecnico if ciclo else '' }}</textarea>

        <label for="resultado_musical">Resultado musical:</label>
        <textarea id="resultado_musical" name="resultado_musical" rows="3">{{ ciclo.resultado_musical if ciclo else '' }}</textarea>

        <h3 class="mt-4">3º Passo</h3>
        <label for="observacoes">Observações:</label>
        <textarea id="observacoes" name="observacoes" rows="3">{{ ciclo.observacoes if ciclo else '' }}</textarea>

        <label for="pensamentos_associados">Pensamentos associados:</label>
        <textarea id="pensamentos_associados" name="pensamentos_associados" rows="3">{{ ciclo.pensamentos_associados if ciclo else '' }}</textarea>

        <label for="emocoes_associadas">Emoções associadas:</label>
        <textarea id="emocoes_associadas" name="emocoes_associadas" rows="3">{{ ciclo.emocoes_associadas if ciclo else '' }}</textarea>

        <label for="diario_reflexivo">Diário reflexivo:</label>
        <textarea id="diario_reflexivo" name="diario_reflexivo" rows="5">{{ ciclo.diario_reflexivo if ciclo else '' }}</textarea>

        <div class="form-group checkbox-group">
            <label for="terminado">Finalizar ciclo</label>
            <input class="form-check-input" type="checkbox" name="terminado" id="terminado" {% if ciclo and ciclo.status == "finalizado" %}checked{% endif %}>
        </div>

        <div class="form-actions">
            <a href="{{ url_for('routes.home') }}" class="btn btn-action cancel">Cancelar</a>
            <button type="submit" class="btn btn-action">Salvar</button>
        </div>
    </form>
{% endblock %}